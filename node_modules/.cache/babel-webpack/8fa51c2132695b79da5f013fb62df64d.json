{"ast":null,"code":"\"use strict\";\n\nvar ɵngcc0 = require('@angular/core');\n\nvar ɵngcc1 = require('./lightbox-config.service');\n\nvar ɵngcc2 = require('./lightbox-event.service');\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar core_1 = require(\"@angular/core\");\n\nvar lightbox_component_1 = require(\"./lightbox.component\");\n\nvar lightbox_config_service_1 = require(\"./lightbox-config.service\");\n\nvar lightbox_event_service_1 = require(\"./lightbox-event.service\");\n\nvar lightbox_overlay_component_1 = require(\"./lightbox-overlay.component\");\n\nvar common_1 = require(\"@angular/common\");\n\nvar Lightbox =\n/** @class */\nfunction () {\n  function Lightbox(_componentFactoryResolver, _injector, _applicationRef, _lightboxConfig, _lightboxEvent, _documentRef) {\n    this._componentFactoryResolver = _componentFactoryResolver;\n    this._injector = _injector;\n    this._applicationRef = _applicationRef;\n    this._lightboxConfig = _lightboxConfig;\n    this._lightboxEvent = _lightboxEvent;\n    this._documentRef = _documentRef;\n  }\n\n  Lightbox.prototype.open = function (album, curIndex, options) {\n    var _this = this;\n\n    if (curIndex === void 0) {\n      curIndex = 0;\n    }\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var overlayComponentRef = this._createComponent(lightbox_overlay_component_1.LightboxOverlayComponent);\n\n    var componentRef = this._createComponent(lightbox_component_1.LightboxComponent);\n\n    var newOptions = {}; // broadcast open event\n\n    this._lightboxEvent.broadcastLightboxEvent({\n      id: lightbox_event_service_1.LIGHTBOX_EVENT.OPEN\n    });\n\n    Object.assign(newOptions, this._lightboxConfig, options); // attach input to lightbox\n\n    componentRef.instance.album = album;\n    componentRef.instance.currentImageIndex = curIndex;\n    componentRef.instance.options = newOptions;\n    componentRef.instance.cmpRef = componentRef; // attach input to overlay\n\n    overlayComponentRef.instance.options = newOptions;\n    overlayComponentRef.instance.cmpRef = overlayComponentRef; // FIXME: not sure why last event is broadcasted (which is CLOSED) and make\n    // lightbox can not be opened the second time.\n    // Need to timeout so that the OPEN event is set before component is initialized\n\n    setTimeout(function () {\n      _this._applicationRef.attachView(overlayComponentRef.hostView);\n\n      _this._applicationRef.attachView(componentRef.hostView);\n\n      overlayComponentRef.onDestroy(function () {\n        _this._applicationRef.detachView(overlayComponentRef.hostView);\n      });\n      componentRef.onDestroy(function () {\n        _this._applicationRef.detachView(componentRef.hostView);\n      });\n      var containerElement = newOptions.containerElementResolver(_this._documentRef);\n      containerElement.appendChild(overlayComponentRef.location.nativeElement);\n      containerElement.appendChild(componentRef.location.nativeElement);\n    });\n  };\n\n  Lightbox.prototype.close = function () {\n    if (this._lightboxEvent) {\n      this._lightboxEvent.broadcastLightboxEvent({\n        id: lightbox_event_service_1.LIGHTBOX_EVENT.CLOSE\n      });\n    }\n  };\n\n  Lightbox.prototype._createComponent = function (ComponentClass) {\n    var factory = this._componentFactoryResolver.resolveComponentFactory(ComponentClass);\n\n    var component = factory.create(this._injector);\n    return component;\n  };\n\n  Lightbox = __decorate([__param(5, core_1.Inject(common_1.DOCUMENT)), __metadata(\"design:paramtypes\", [core_1.ComponentFactoryResolver, core_1.Injector, core_1.ApplicationRef, lightbox_config_service_1.LightboxConfig, lightbox_event_service_1.LightboxEvent, Object])], Lightbox);\n\n  Lightbox.ɵfac = function Lightbox_Factory(t) {\n    return new (t || Lightbox)(ɵngcc0.ɵɵinject(ɵngcc0.ComponentFactoryResolver), ɵngcc0.ɵɵinject(ɵngcc0.Injector), ɵngcc0.ɵɵinject(ɵngcc0.ApplicationRef), ɵngcc0.ɵɵinject(ɵngcc1.LightboxConfig), ɵngcc0.ɵɵinject(ɵngcc2.LightboxEvent), ɵngcc0.ɵɵinject(common_1.DOCUMENT));\n  };\n\n  Lightbox.ɵprov = ɵngcc0.ɵɵdefineInjectable({\n    token: Lightbox,\n    factory: function factory(t) {\n      return Lightbox.ɵfac(t);\n    }\n  });\n\n  (function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(Lightbox, [{\n      type: core_1.Injectable\n    }], function () {\n      return [{\n        type: ɵngcc0.ComponentFactoryResolver\n      }, {\n        type: ɵngcc0.Injector\n      }, {\n        type: ɵngcc0.ApplicationRef\n      }, {\n        type: ɵngcc1.LightboxConfig\n      }, {\n        type: ɵngcc2.LightboxEvent\n      }, {\n        type: Object,\n        decorators: [{\n          type: core_1.Inject,\n          args: [common_1.DOCUMENT]\n        }]\n      }];\n    }, null);\n  })();\n\n  return Lightbox;\n}();\n\nexports.Lightbox = Lightbox;","map":{"version":3,"sources":["lightbox.service.js"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar core_1 = require(\"@angular/core\");\nvar lightbox_component_1 = require(\"./lightbox.component\");\nvar lightbox_config_service_1 = require(\"./lightbox-config.service\");\nvar lightbox_event_service_1 = require(\"./lightbox-event.service\");\nvar lightbox_overlay_component_1 = require(\"./lightbox-overlay.component\");\nvar common_1 = require(\"@angular/common\");\nvar Lightbox = /** @class */ (function () {\n    function Lightbox(_componentFactoryResolver, _injector, _applicationRef, _lightboxConfig, _lightboxEvent, _documentRef) {\n        this._componentFactoryResolver = _componentFactoryResolver;\n        this._injector = _injector;\n        this._applicationRef = _applicationRef;\n        this._lightboxConfig = _lightboxConfig;\n        this._lightboxEvent = _lightboxEvent;\n        this._documentRef = _documentRef;\n    }\n    Lightbox.prototype.open = function (album, curIndex, options) {\n        var _this = this;\n        if (curIndex === void 0) { curIndex = 0; }\n        if (options === void 0) { options = {}; }\n        var overlayComponentRef = this._createComponent(lightbox_overlay_component_1.LightboxOverlayComponent);\n        var componentRef = this._createComponent(lightbox_component_1.LightboxComponent);\n        var newOptions = {};\n        // broadcast open event\n        this._lightboxEvent.broadcastLightboxEvent({ id: lightbox_event_service_1.LIGHTBOX_EVENT.OPEN });\n        Object.assign(newOptions, this._lightboxConfig, options);\n        // attach input to lightbox\n        componentRef.instance.album = album;\n        componentRef.instance.currentImageIndex = curIndex;\n        componentRef.instance.options = newOptions;\n        componentRef.instance.cmpRef = componentRef;\n        // attach input to overlay\n        overlayComponentRef.instance.options = newOptions;\n        overlayComponentRef.instance.cmpRef = overlayComponentRef;\n        // FIXME: not sure why last event is broadcasted (which is CLOSED) and make\n        // lightbox can not be opened the second time.\n        // Need to timeout so that the OPEN event is set before component is initialized\n        setTimeout(function () {\n            _this._applicationRef.attachView(overlayComponentRef.hostView);\n            _this._applicationRef.attachView(componentRef.hostView);\n            overlayComponentRef.onDestroy(function () {\n                _this._applicationRef.detachView(overlayComponentRef.hostView);\n            });\n            componentRef.onDestroy(function () {\n                _this._applicationRef.detachView(componentRef.hostView);\n            });\n            var containerElement = newOptions.containerElementResolver(_this._documentRef);\n            containerElement.appendChild(overlayComponentRef.location.nativeElement);\n            containerElement.appendChild(componentRef.location.nativeElement);\n        });\n    };\n    Lightbox.prototype.close = function () {\n        if (this._lightboxEvent) {\n            this._lightboxEvent.broadcastLightboxEvent({ id: lightbox_event_service_1.LIGHTBOX_EVENT.CLOSE });\n        }\n    };\n    Lightbox.prototype._createComponent = function (ComponentClass) {\n        var factory = this._componentFactoryResolver.resolveComponentFactory(ComponentClass);\n        var component = factory.create(this._injector);\n        return component;\n    };\n    Lightbox = __decorate([\n        core_1.Injectable(),\n        __param(5, core_1.Inject(common_1.DOCUMENT)),\n        __metadata(\"design:paramtypes\", [core_1.ComponentFactoryResolver,\n            core_1.Injector,\n            core_1.ApplicationRef,\n            lightbox_config_service_1.LightboxConfig,\n            lightbox_event_service_1.LightboxEvent, Object])\n    ], Lightbox);\n    return Lightbox;\n}());\nexports.Lightbox = Lightbox;\n"]},"metadata":{},"sourceType":"script"}